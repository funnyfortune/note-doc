(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{469:function(s,a,t){"use strict";t.r(a);var n=t(6),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-环境准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-环境准备"}},[s._v("#")]),s._v(" 1. 环境准备")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("IP")]),s._v(" "),a("th",[s._v("操作系统")]),s._v(" "),a("th")])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("192.168.137.14")]),s._v(" "),a("td",[s._v("CentOS 7.6.1810")]),s._v(" "),a("td",[s._v("Nginx+mysql+nacos")])]),s._v(" "),a("tr",[a("td",[s._v("192.168.137.15")]),s._v(" "),a("td",[s._v("CentOS 7.6.1810")]),s._v(" "),a("td",[s._v("nacos")])]),s._v(" "),a("tr",[a("td",[s._v("192.168.137.16")]),s._v(" "),a("td",[s._v("CentOS 7.6.1810")]),s._v(" "),a("td",[s._v("nacos")])])])]),s._v(" "),a("h3",{attrs:{id:"_1-1-安装和配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-安装和配置"}},[s._v("#")]),s._v(" 1.1 安装和配置")]),s._v(" "),a("p",[s._v("需要使用的mysql，如果没有安装mysql，请参考如下的方式进行安装： https://www.cnblogs.com/luohanguo/p/9045391.html")]),s._v(" "),a("p",[s._v("在mysql中创建数据库“nacos_config”，执行nacos安装包中的“nacos-mysql.sql”")]),s._v(" "),a("p",[s._v("下载"),a("a",{attrs:{href:"https://github.com/alibaba/nacos/releases/download/1.2.1/nacos-server-1.2.1.zip",target:"_blank",rel:"noopener noreferrer"}},[s._v("nacos-server-1.2.1"),a("OutboundLink")],1),s._v("，到/opt/software目录中：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nacos software"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n-rw-r--r--. "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root    root     "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("56051518")]),s._v(" Apr "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("18")]),s._v(" 09:11 nacos-server-1.2.1.zip\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("将137.14上的nacos安装包，传送到另外两台设备上：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nacos software"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp nacos-server-1.2.1.zip root@192.168.137.15:$PWD")]),s._v("\nroot@192.168.137.15"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s password: \nnacos-server-1.2.1.zip                                                                                                   100%   53MB  26.7MB/s   00:02    \n[root@nacos software]# scp nacos-server-1.2.1.zip root@192.168.137.16:$PWD\nroot@192.168.137.16'")]),s._v("s password: \nnacos-server-1.2.1.zip                                                                                                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v("%   53MB  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(".7MB/s   00:02    \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@nacos software"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("分别在三台设备上执行如下的命令：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("unzip")]),s._v(" /opt/software/nacos-server-1.2.1.zip  -d /opt/module/nacos-cluster  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/module/nacos-cluster/nacos  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" conf/cluster.conf.example  conf/cluster.conf  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" \n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"192.168.137.14:8848\n192.168.137.15:8848\n192.168.137.16:8848"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("  conf/cluster.conf  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -i s/server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v("/server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v(".port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v("/  conf/application.properties  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\n\nspring.datasource.platform=mysql\n\ndb.num=1\ndb.url.0=jdbc:mysql://192.168.137.14:3306/nacos_config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true\ndb.user=root\ndb.password=Admin@123"')]),s._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" conf/application.properties  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" bin/startup.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("分别启动3台设备上的nacos。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@hadoop-104 bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh startup.sh")]),s._v("\n/opt/module/jdk1.8.0_144/bin/java  -server -Xms2g -Xmx2g -Xmn1g -XX:MetaspaceSize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("128m -XX:MaxMetaspaceSize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("320m -XX:-OmitStackTraceInFastThrow -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/nacos/logs/java_heapdump.hprof -XX:-UseLargePages -Djava.ext.dirs"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/jdk1.8.0_144/jre/lib/ext:/opt/module/jdk1.8.0_144/lib/ext -Xloggc:/opt/module/nacos/logs/nacos_gc.log -verbose:gc -XX:+PrintGCDetails -XX:+PrintGCDateStamps -XX:+PrintGCTimeStamps -XX:+UseGCLogFileRotation -XX:NumberOfGCLogFiles"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -XX:GCLogFileSize"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("100M -Dloader.path"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/nacos/plugins/health,/opt/module/nacos/plugins/cmdb,/opt/module/nacos/plugins/mysql -Dnacos.home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/nacos -jar /opt/module/nacos/target/nacos-server.jar  --spring.config.location"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("classpath:/,classpath:/config/,file:./,file:./config/,file:/opt/module/nacos/conf/ --logging.config"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/opt/module/nacos/conf/nacos-logback.xml --server.max-http-header-size"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524288")]),s._v("\nnacos is starting with cluster\nnacos is starting，you can check the /opt/module/nacos/logs/start.out\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@hadoop-104 bin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"_1-2-测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-测试"}},[s._v("#")]),s._v(" 1.2 测试")]),s._v(" "),a("p",[s._v("http://192.168.137.14:8848/nacos/#/clusterManagement?dataId=&group=&appName=&namespace=")]),s._v(" "),a("p",[s._v("http://192.168.137.15:8848/nacos/#/clusterManagement?dataId=&group=&appName=&namespace=")]),s._v(" "),a("p",[s._v("http://192.168.137.16:8848/nacos/#/clusterManagement?dataId=&group=&appName=&namespace=")]),s._v(" "),a("h3",{attrs:{id:"_1-3-配置nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-配置nginx"}},[s._v("#")]),s._v(" 1.3 配置Nginx")]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\tupstream")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("nacosserver {")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\t   server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("192.168.137.14:8848;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\t   server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("192.168.137.15:8848;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\t   server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("192.168.137.16:8848;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\t}")]),s._v(" \n\t\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("    server")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("{")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("        listen")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("80;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("        server_name")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("www.mynacos.com;")]),s._v("\n   \n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("        location")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("/ {")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("\t\t     root")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("  html;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("             proxy_pass")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("http://nacosserver;")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("             index")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("index.html index.htm;")]),s._v("\n        }\n    }\t\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("在本地windows上修改hosts文件，添加“192.168.137.14 www.mynacos.com”域名映射规则。")]),s._v(" "),a("p",[s._v("http://www.mynacos.com/nacos/#/clusterManagement?dataId=&group=&appName=&namespace=")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/image-20200421222016859.png",alt:"image-20200421222016859"}})]),s._v(" "),a("p",[s._v("停止192.168.137.14上的nacos服务，192.168.137.16选为新的Leader")]),s._v(" "),a("p",[s._v("http://www.mynacos.com/nacos/#/clusterManagement?dataId=&group=&appName=&namespace=")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/image-20200421222239858.png",alt:"image-20200421222239858"}})]),s._v(" "),a("p",[s._v("参考链接：")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/FlyAway2013/p/11201250.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos 集群部署"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"_4-将-cloudalibaba-provider-payment9002-微服务注册到nacos集群上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-将-cloudalibaba-provider-payment9002-微服务注册到nacos集群上"}},[s._v("#")]),s._v(" 4. 将“cloudalibaba-provider-payment9002”微服务注册到nacos集群上")]),s._v(" "),a("p",[a("img",{attrs:{src:"images/image-20200422001421327.png",alt:"image-20200422001421327"}})]),s._v(" "),a("h2",{attrs:{id:"_2-基于docker的nacos环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-基于docker的nacos环境"}},[s._v("#")]),s._v(" 2. 基于Docker的nacos环境")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("服务器OS")]),s._v(" "),a("th",[s._v("主机IP")]),s._v(" "),a("th",[s._v("Docker版本")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("centos7.6")]),s._v(" "),a("td",[s._v("192.168.137.14")]),s._v(" "),a("td",[s._v("19.03.1")])]),s._v(" "),a("tr",[a("td",[s._v("centos7.6")]),s._v(" "),a("td",[s._v("192.168.137.15")]),s._v(" "),a("td",[s._v("19.03.1")])]),s._v(" "),a("tr",[a("td",[s._v("centos7.6")]),s._v(" "),a("td",[s._v("192.168.137.16")]),s._v(" "),a("td",[s._v("19.03.1")])])])]),s._v(" "),a("p",[s._v("安装docker-compose（ docker 提供的一个命令行工具，用来定义和运行由多个容器组成的应用）")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -L "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://github.com/docker/compose/releases/download/1.25.5/docker-compose-'),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -s"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("-"),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("uname")]),s._v(" -m"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v('"')]),s._v(" -o /usr/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("赋权")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /usr/bin/docker-compose\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("查看版本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" --version\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/nacos-cluster-docker/init.d/ "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /opt/nacos-cluster-docker/init.d/custom.properties \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/nacos-cluster-docker/nacos-1/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /opt/nacos-cluster-docker/nacos-1/docker-compose-nacos1.yml \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/nacos-cluster-docker/nacos-2/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /opt/nacos-cluster-docker/nacos-2/docker-compose-nacos2.yml \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /opt/nacos-cluster-docker/nacos-3/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /opt/nacos-cluster-docker/nacos-3/docker-compose-nacos3.yml \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("14服务器的"),a("code",[s._v("docker-compose-nacos1.yml")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("version")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("services")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos-server服务注册与发现，配置中心服务    ")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("docker-nacos-server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos/nacos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("container_name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8848:8848"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9555:9555"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" nacos_net\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("restart")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" on"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("failure\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("privileged")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("environment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("PREFER_HOST_MODE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ip "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果支持主机名可以使用hostname,否则使用ip，默认也是ip")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("SPRING_DATASOURCE_PLATFORM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据源平台 仅支持mysql或不保存empty")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("NACOS_SERVER_IP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.137.14 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多网卡情况下，指定ip或网卡")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("NACOS_SERVERS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.137.14"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8848 192.168.137.15"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("8848 192.168.137.16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8848")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集群中其它节点[ip1:port ip2:port ip3:port]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_MASTER_SERVICE_HOST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.137.14 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysql配置，Master为主节点，Slave为从节点")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_MASTER_SERVICE_PORT")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_MASTER_SERVICE_DB_NAME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nacos_config\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_MASTER_SERVICE_USER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("MYSQL_MASTER_SERVICE_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Admin@123\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_HOST: 10.2.7.29")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_PORT: 3341")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM调优参数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMS:  #-Xms default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMX:  #-Xmx default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMN:  #-Xmn default :1g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MS:   #-XX:MetaspaceSize default :128m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MMS:  #-XX:MaxMetaspaceSize default :320m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#NACOS_DEBUG: n #是否开启远程debug，y/n，默认n")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TOMCAT_ACCESSLOG_ENABLED: true #是否开始tomcat访问日志的记录，默认false")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ./cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("logs/nacos1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/home/nacos/logs "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志输出目录")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ../init.d/custom.properties"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/home/nacos/init.d/custom.properties "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#../init.d/custom.properties内包含很多自定义配置，可按需配置")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("networks")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nacos_net")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("driver")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" bridge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("15服务器的"),a("code",[s._v("docker-compose-nacos2.yml")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("version: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v(" \nservices:\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos-server服务注册与发现，配置中心服务    ")]),s._v("\n  docker-nacos-server:\n    image: nacos/nacos-server:latest\n    container_name: nacos-server-2\n    ports:\n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8848:8848"')]),s._v("\n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9555:9555"')]),s._v("\n    networks: nacos_net\n    restart: \n      - on-failure\n    privileged: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    environment:\n      PREFER_HOST_MODE: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果支持主机名可以使用hostname,否则使用ip，默认也是ip")]),s._v("\n      SPRING_DATASOURCE_PLATFORM: mysql "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据源平台 仅支持mysql或不保存empty")]),s._v("\n      NACOS_SERVER_IP: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.15 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多网卡情况下，指定ip或网卡")]),s._v("\n      NACOS_SERVERS: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.14:8848 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.15:8848 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.16:8848 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集群中其它节点[ip1:port ip2:port ip3:port]")]),s._v("\n      MYSQL_MASTER_SERVICE_HOST: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.14 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysql配置，Master为主节点，Slave为从节点")]),s._v("\n      MYSQL_MASTER_SERVICE_PORT: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n      MYSQL_MASTER_SERVICE_DB_NAME: nacos_config\n      MYSQL_MASTER_SERVICE_USER: root\n      MYSQL_MASTER_SERVICE_PASSWORD: Admin@123\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_HOST: 10.2.7.29")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_PORT: 3341")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM调优参数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMS:  #-Xms default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMX:  #-Xmx default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMN:  #-Xmn default :1g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MS:   #-XX:MetaspaceSize default :128m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MMS:  #-XX:MaxMetaspaceSize default :320m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#NACOS_DEBUG: n #是否开启远程debug，y/n，默认n")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TOMCAT_ACCESSLOG_ENABLED: true #是否开始tomcat访问日志的记录，默认false")]),s._v("\n    volumes:\n      - ./cluster-logs/nacos2:/home/nacos/logs "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志输出目录")]),s._v("\n      - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/init.d/custom.properties:/home/nacos/init.d/custom.properties "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#../init.d/custom.properties内包含很多自定义配置，可按需配置")]),s._v("\n\nnetworks:\n  nacos_net:\n    driver: bridge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("16服务器的"),a("code",[s._v("docker-compose-nacos3.yml")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("version: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'3'")]),s._v(" \nservices:\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nacos-server服务注册与发现，配置中心服务    ")]),s._v("\n  docker-nacos-server:\n    image: nacos/nacos-server:latest\n    container_name: nacos-server-3\n    ports:\n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8848:8848"')]),s._v("\n      - "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"9555:9555"')]),s._v("\n    networks: \n      - nacos_net\n    restart: on-failure\n    privileged: "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n    environment:\n      PREFER_HOST_MODE: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ip")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果支持主机名可以使用hostname,否则使用ip，默认也是ip")]),s._v("\n      SPRING_DATASOURCE_PLATFORM: mysql "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据源平台 仅支持mysql或不保存empty")]),s._v("\n      NACOS_SERVER_IP: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.16 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#多网卡情况下，指定ip或网卡")]),s._v("\n      NACOS_SERVERS: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.14:8848 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.15:8848 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.16:8848 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#集群中其它节点[ip1:port ip2:port ip3:port]")]),s._v("\n      MYSQL_MASTER_SERVICE_HOST: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".137.14 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#mysql配置，Master为主节点，Slave为从节点")]),s._v("\n      MYSQL_MASTER_SERVICE_PORT: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\n      MYSQL_MASTER_SERVICE_DB_NAME: nacos_config\n      MYSQL_MASTER_SERVICE_USER: root\n      MYSQL_MASTER_SERVICE_PASSWORD: Admin@123\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_HOST: 10.2.7.29")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#MYSQL_SLAVE_SERVICE_PORT: 3341")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM调优参数")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMS:  #-Xms default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMX:  #-Xmx default :2g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_XMN:  #-Xmn default :1g")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MS:   #-XX:MetaspaceSize default :128m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#JVM_MMS:  #-XX:MaxMetaspaceSize default :320m")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#NACOS_DEBUG: n #是否开启远程debug，y/n，默认n")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#TOMCAT_ACCESSLOG_ENABLED: true #是否开始tomcat访问日志的记录，默认false")]),s._v("\n    volumes:\n      - ./cluster-logs/nacos3:/home/nacos/logs "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#日志输出目录")]),s._v("\n      - "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/init.d/custom.properties:/home/nacos/init.d/custom.properties "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#../init.d/custom.properties内包含很多自定义配置，可按需配置")]),s._v("\n\nnetworks:\n  nacos_net:\n    driver: bridge\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("Nacos共用的"),a("code",[s._v("init.d/custom.properties")]),s._v("，与官方保持一致，按需使用")]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#spring.security.enabled=false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.security=false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#security.basic.enabled=false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#nacos.security.ignore.urls=/**")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.elastic.host=http://localhost:9200")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metrics for prometheus")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key attr-name"}},[s._v("management.endpoints.web.exposure.include")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token value attr-value"}},[s._v("*")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metrics for elastic search")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.elastic.enabled=false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.elastic.host=http://localhost:9200")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# metrics for influx")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.enabled=false")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.db=springboot")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.uri=http://localhost:8086")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.auto-create-db=true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.consistency=one")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#management.metrics.export.influx.compressed=true")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("h3",{attrs:{id:"启动容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),a("p",[s._v("分别在各主机上进入各自对应的nacos目录中，启动容器，命令如下：")]),s._v(" "),a("p",[s._v("14服务器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" nacos-cluster-docker/nacos-1\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" -f docker-compose-nacos1.yml up -d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("15服务器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" nacos-cluster-docker/nacos-2\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" -f docker-compose-nacos2.yml up -d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("16服务器")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" nacos-cluster-docker/nacos-3\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker-compose")]),s._v(" -f docker-compose-nacos3.yml up -d\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("参考链接："),a("a",{attrs:{href:"https://www.cnblogs.com/hellxz/p/nacos-cluster-docker.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos高可用集群解决方案-Docker版本"),a("OutboundLink")],1)]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/xuchen0117/p/11725812.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nacos Docker集群部署"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);