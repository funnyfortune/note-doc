(window.webpackJsonp=window.webpackJsonp||[]).push([[211],{539:function(r,e,a){"use strict";a.r(e);var s=a(7),t=Object(s.a)({},(function(){var r=this,e=r._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("p",[r._v("目录")]),r._v(" "),e("p",[e("a",{attrs:{href:"#_1-%E8%A1%A8%E7%BB%93%E6%9E%84"}},[r._v("1. 表结构")])]),r._v(" "),e("p",[e("a",{attrs:{href:"#_2-%E7%B2%89%E4%B8%9D%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2"}},[r._v("2. 粉丝管理界面")])]),r._v(" "),e("p",[e("a",{attrs:{href:"#_3-%E5%90%8C%E6%AD%A5%E7%B2%89%E4%B8%9D"}},[r._v("3. 同步粉丝")])]),r._v(" "),e("p",[e("a",{attrs:{href:"#_4-%E5%85%B3%E6%B3%A8-subscribehandler"}},[r._v("4. 关注 SubscribeHandler")])]),r._v(" "),e("p",[e("a",{attrs:{href:"#_5-%E5%8F%96%E5%85%B3-unsubscribehandler"}},[r._v("5. 取关 UnsubscribeHandler")])]),r._v(" "),e("h1",{attrs:{id:"公众号粉丝"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#公众号粉丝"}},[r._v("#")]),r._v(" "),e("img",{attrs:{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==",alt:"null"}}),r._v("公众号粉丝")]),r._v(" "),e("p",[r._v("本章节，讲解公众号粉丝的相关内容，包括关注、取消关注等等，对应 "),e("a",{attrs:{href:"https://developers.weixin.qq.com/doc/offiaccount/User_Management/Getting_a_User_List.html",target:"_blank",rel:"noopener noreferrer"}},[r._v("《微信公众号官方文档 —— 获取用户列表》 "),e("OutboundLink")],1),r._v(" 文档。")]),r._v(" "),e("p",[e("img",{attrs:{src:"/note-doc/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%89%8B%E5%86%8C/%E5%85%AC%E4%BC%97%E5%8F%B7%E7%B2%89%E4%B8%9D/%E7%95%8C%E9%9D%A2.png",alt:"粉丝管理"}})]),r._v(" "),e("h2",{attrs:{id:"_1-表结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-表结构"}},[r._v("#")]),r._v(" 1. 表结构")]),r._v(" "),e("p",[r._v("公众号粉丝对应  "),e("code",[r._v("mp_user")]),r._v("  表，结构如下图所示：")]),r._v(" "),e("p",[e("img",{attrs:{src:"/note-doc/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%89%8B%E5%86%8C/%E5%85%AC%E4%BC%97%E5%8F%B7%E7%B2%89%E4%B8%9D/%E8%A1%A8%E7%BB%93%E6%9E%84.png",alt:"表结构"}})]),r._v(" "),e("p",[r._v("注意，自 2021-12-27 开始，公众号接口不再返回头像和昵称，只能通过微信公众号的网页登录获取。因此，表中的  "),e("code",[r._v("avatar")]),r._v("  和  "),e("code",[r._v("nickname")]),r._v("  字段，往往是空的。")]),r._v(" "),e("h2",{attrs:{id:"_2-粉丝管理界面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-粉丝管理界面"}},[r._v("#")]),r._v(" 2. 粉丝管理界面")]),r._v(" "),e("ul",[e("li",[e("p",[r._v("前端："),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-ui-admin/src/views/mp/user/index.vue",target:"_blank",rel:"noopener noreferrer"}},[r._v("/@views/mp/user "),e("OutboundLink")],1)])]),r._v(" "),e("li",[e("p",[r._v("后端："),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/controller/admin/user/MpUserController.java",target:"_blank",rel:"noopener noreferrer"}},[r._v("MpUserController "),e("OutboundLink")],1)])])]),r._v(" "),e("h2",{attrs:{id:"_3-同步粉丝"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-同步粉丝"}},[r._v("#")]),r._v(" 3. 同步粉丝")]),r._v(" "),e("p",[r._v("点击粉丝管理界面的【同步】按钮，可以 "),e("strong",[r._v("异步")]),r._v(" 从公众号同步所有的粉丝信息，存储到  "),e("code",[r._v("mp_user")]),r._v("  表中。如果你的粉丝较多，可能需要等待一段时间。")]),r._v(" "),e("p",[r._v("对应后端的 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/user/MpUserServiceImpl.java#L95-L161",target:"_blank",rel:"noopener noreferrer"}},[r._v("MpUserServiceImpl "),e("OutboundLink")],1),r._v(" 的  "),e("code",[r._v("syncUser")]),r._v("  方法。")]),r._v(" "),e("h2",{attrs:{id:"_4-关注-subscribehandler"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-关注-subscribehandler"}},[r._v("#")]),r._v(" 4. 关注 SubscribeHandler")]),r._v(" "),e("p",[r._v("用户关注公众号时，会触发 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/handler/user/SubscribeHandler.java",target:"_blank",rel:"noopener noreferrer"}},[r._v("SubscribeHandler "),e("OutboundLink")],1),r._v(" 处理器，新增或修改  "),e("code",[r._v("mp_user")]),r._v("  粉丝信息。")]),r._v(" "),e("p",[e("img",{attrs:{src:"/note-doc/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%89%8B%E5%86%8C/%E5%85%AC%E4%BC%97%E5%8F%B7%E7%B2%89%E4%B8%9D/SubscribeHandler.png",alt:"SubscribeHandler"}})]),r._v(" "),e("h2",{attrs:{id:"_5-取关-unsubscribehandler"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_5-取关-unsubscribehandler"}},[r._v("#")]),r._v(" 5. 取关 UnsubscribeHandler")]),r._v(" "),e("p",[r._v("用户取消关注公众号时，会触发 "),e("a",{attrs:{href:"https://github.com/YunaiV/ruoyi-vue-pro/blob/master/yudao-module-mp/yudao-module-mp-biz/src/main/java/cn/iocoder/yudao/module/mp/service/handler/user/UnsubscribeHandler.java",target:"_blank",rel:"noopener noreferrer"}},[r._v("UnsubscribeHandler "),e("OutboundLink")],1),r._v(" 处理器，标记  "),e("code",[r._v("mp_user")]),r._v("  粉丝信息为取消关注，设置  "),e("code",[r._v("subscribe_status")]),r._v("  字段为 0。")]),r._v(" "),e("p",[e("img",{attrs:{src:"/note-doc/img/%E5%85%AC%E4%BC%97%E5%8F%B7%E6%89%8B%E5%86%8C/%E5%85%AC%E4%BC%97%E5%8F%B7%E7%B2%89%E4%B8%9D/UnsubscribeHandler.png",alt:"UnsubscribeHandler"}})])])}),[],!1,null,null,null);e.default=t.exports}}]);